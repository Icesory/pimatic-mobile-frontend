(function(){!function(){var a,b;return b=function(a,b){var c,d;return d=function(){var b,d,e,f;for(e=a.attr("class").split(" "),f=[],b=0,d=e.length;d>b;b++)c=e[b],0!==c.lastIndexOf("ui-icon-")&&f.push(c);return f}(),d.push("ui-icon-"+b),a.attr("class",d.join(" "))},ko.bindingHandlers.jqmbutton={init:function(a,b){var c,d,e;d=b(),e=ko.unwrap(d),c=$(a)},update:function(a,c){var d,e,f,g,h;g=c(),h=ko.unwrap(g),d=$(a),null!=h.text&&(f=ko.unwrap(h.text),d.text(f)),null!=h.icon&&(e=ko.unwrap(h.icon),b(d,e))}},ko.bindingHandlers.jqmlistitem={update:function(a,c){var d,e,f,g;return f=c(),g=ko.unwrap(f),d=$(a),null!=f.icon?(e=ko.unwrap(f.icon),b(d,e)):void 0}},ko.bindingHandlers.jqmenabled={update:function(a,b){var c,d,e;d=b(),e=ko.unwrap(d),c=$(a),c.textinput(e?"enable":"disable")}},ko.bindingHandlers.jqmchecked={init:ko.bindingHandlers.checked.init,update:function(a,b){var c,d;c=b(),d=ko.unwrap(c),$(a).checkboxradio("refresh")}},ko.bindingHandlers.jqmselectedOptions={init:function(a,b){var c,d;return d=b(),c=$(a),c.on("change",function(){return function(){var a;return a=c.val(),null==a&&(a=[]),d(a)}}(this))},update:function(a,b){var c,d;d=b(),c=$(a),c.val(d()),c.selectmenu("refresh",!0)}},ko.bindingHandlers.jqmoptions={init:ko.bindingHandlers.options.init,update:function(a,b,c){var d;ko.bindingHandlers.options.update(a,b,c),d=b(),$(a).selectmenu("refresh")}},a=function(a){return this.element=a,this.$element=$(a),this.scrollMargin=Math.floor(this.$element.innerHeight()/10),this.offset=this.$element.offset(),this.innerHeight=this.$element.innerHeight(),this.scrollDeltaMin=5,this.scrollDeltaMax=30},a.prototype.scroll=function(a,b){var c,d,e,f,g,h;return h=this.scrollMargin+this.offset.top,g=void 0,d=0,h>b&&(g=(h-b)/this.scrollMargin,d=-(g*(this.scrollDeltaMax-this.scrollDeltaMin)+this.scrollDeltaMin)),c=this.offset.top+this.innerHeight-this.scrollMargin,b>c&&(g=(b-c)/this.scrollMargin,d=g*(this.scrollDeltaMax-this.scrollDeltaMin)+this.scrollDeltaMin),0!==d&&(e=this.$element.scrollTop(),f=this.$element.scrollTop(e+d),d=this.$element.scrollTop()-e),d},ko.bindingHandlers.sortable={init:function(b,c,d,e){var f,g,h;return h=c(),g=h.items,f=function(){return function(a){var c,d,e,f,g;return f=null,d=null,g=null,e=null,c=a.offset(),$(b).find(".sortable").each(function(b,h){var i,j,k;if(h!==a[0])if(i=$(h).offset(),i.top<c.top){if(null==g||i.top>g.top)return j=[h,i],f=j[0],g=j[1],j}else if(i.top>c.top&&(null==e||i.top<e.top))return k=[h,i],d=k[0],e=k[1],k}),{eleBefore:f,eleAfter:d}}}(this),$(b).on("MSPointerDown touchstart mousedown",".handle",function(c){var d,i,j,k,l,m,n,o;return i=$(this).parents(".sortable"),m=function(){return function(){var a,c,d,e,g,h,j,k;return j=i.offset(),g=i.outerHeight(),j.bottom=j.top+g,k=f(i),d=k.eleBefore,a=k.eleAfter,$(b).find(".sortable").each(function(a,b){return b!==i[0]?($(b).css("margin-bottom",0),$(b).css("margin-top",0)):void 0}),null!=d?(e=$(d).offset(),e.width=$(d).outerHeight(),e.middle=e.top+e.width/2,e.bottom=e.top+e.width,j.top<e.middle?$(d).css("margin-top",g):null!=a?(c=$(a).offset(),c.width=$(a).outerHeight(),c.middle=c.top+c.width/2,j.bottom>c.middle&&j.top>e.bottom+g/2?$(a).css("margin-bottom",g):$(d).css("margin-bottom",g)):$(d).css("margin-bottom",g)):null!=a&&$(a).css("margin-top",g),h=j.top-i.offset().top,0!==h?i.data("plugin_pep").doMoveTo(0,h):void 0}}(this),l=function(){return function(){var a,b,c,d,j,k,l,m,n;return n=f(i),c=n.eleBefore,b=n.eleAfter,(null!==c||null!==b)&&(k=g.indexOf(ko.dataFor(i[0])),l=null!=c?(a=ko.dataFor(c),d=g.indexOf(a)+1,d>k?d--:void 0,d):0,k>=0&&l>=0&&k!==l&&(m=ko.utils.unwrapObservable(g),j=m[k],g.valueWillMutate(),m.splice(k,1),m.splice(l,0,j),g.valueHasMutated(),h.sorted))?h.sorted.call(e):void 0}}(this),n=null,o=null,j=null,k=null,d=null,i.pep({place:!1,axis:"y",shouldEase:!1,constrainTo:"parent",droppable:".droppable",overlapFunction:function(){return function(a,b){var c,d,e;return d=a[0].getBoundingClientRect(),e=b[0].getBoundingClientRect(),c=e.bottom-d.bottom>-20&&e.bottom-d.bottom<10}}(this),start:function(){return function(){var c,e;return $(b).css("height",$(b).height()),clearTimeout(d),null!=h.isSorting&&h.isSorting(!0),$(b).addClass("noAnimation"),i.css("margin-bottom",-i.innerHeight()),j=new a($("#index .ui-content.overthrow")[0]),c=null,e=null,k=setInterval(function(){var a;return a=j.scroll(n,o),0!==a?i.data("plugin_pep").doMoveTo(0,a):void 0},100)}}(this),stop:function(){return function(a,c){var f,g;return clearTimeout(k),f=c.activeDropRegions.length>0,$(c.activeDropRegions).each(function(a,b){return null!=h.drop?h.drop.call(e,ko.dataFor(i[0]),b):void 0}),f||l(),g=i.data("plugin_pep"),$.pep.unbind(i),$(b).find(".sortable").attr("style",""),$(b).css("height",""),null!=h.isSorting&&h.isSorting(!1),d=setTimeout(function(){return $(b).removeClass("noAnimation")},100),i.removeClass("ui-btn-active")}}(this),drag:function(){return function(a){return n=a.pageX,o=a.pageY,m(),!0}}(this)}),i.data("plugin_pep").handleStart(c),c.stopImmediatePropagation()})}},ko.bindingHandlers.jqmselectvalue={init:function(a,b,c,d){return"undefined"!=typeof ko.bindingHandlers.value.init?ko.bindingHandlers.value.init(a,b,c,d):void 0},update:function(a,b,c,d){return"undefined"!=typeof ko.bindingHandlers.value.update&&ko.bindingHandlers.value.update(a,b,c,d),$(a).selectmenu("refresh",!0)}},ko.bindingHandlers.dragslide={init:function(a,b){var c,d,e,f,g,h,i;h=b(),i=ko.toJS(h),c=i.options||{},$(a).css({overflow:"hidden"}),$(a).on("selectstart mousedown",function(a){return a.preventDefault()}),g=function(){return function(a,b){return $(".drag-message").text(b).css({top:a.position().top,height:a.outerHeight(),"line-height":a.outerHeight()+"px"}).fadeIn(500)}}(this),e=null,d=!1,$(a).on("click",function(a){return d?a.preventDefault():e=null}),f=null,$(a).on("vmousedown",".draggable",function(){return function(a){return f=$(a.target).parents(".draggable"),(null!=f?f.length:void 0)?e=a:void 0}}(this)),$(a).on("vmousemove",".draggable",function(){return function(a){var b,c,h,i,j,k;return k=$(a.target).parents(".draggable"),null!=e&&(null!=k?k.length:void 0)&&(null!=f?f.length:void 0)&&f[0]===k[0]?(c=Math.abs(a.pageX-e.pageX),h=Math.abs(a.pageY-e.pageY),c>h&&c>5?(a.preventDefault(),a.stopPropagation(),e.preventDefault(),i=ko.dataFor(k[0]),b=null,j=k.position(),k.pep({place:!1,axis:"x",shouldEase:!0,revert:!0,shouldPreventDefault:!1,start:function(){return d=!0},rest:function(){var a;return a=k.data("plugin_pep"),$.pep.unbind(k),k.attr("style",""),d=!1},drag:function(){var a;return a=k.position().left-j.left,-120>a?"deactivate"!==b&&(g(k,__("deactivate rule")).addClass("deactivate").removeClass("activate"),b="deactivate"):a>120?"activate"!==b&&(g(k,__("activate rule")).addClass("activate").removeClass("deactivate"),b="activate"):null!=b&&($(".drag-message").fadeOut(500),b=null),!0},stop:function(){return $(".drag-message").text("").fadeOut().removeClass("activate").removeClass("deactivate"),null!=b&&(pimatic.loading("saveactivate","show",{text:__(b)}),$.ajax("/api/rule/"+i.id+"/"+b,{global:!1}).always(function(){return pimatic.loading("saveactivate","hide")}).done(ajaxShowToast).fail(ajaxAlertFail)),k.removeClass("ui-btn-active")}}),k.data("plugin_pep").revert=function(){return this.shouldUseCSSTranslation()&&this.moveToUsingTransforms(-this.xTranslation(),0),this.moveTo(this.initialPosition.left,0)},k.data("plugin_pep").handleStart(e),e=null):void 0):(f=null,void(e=null))}}(this))}}}()}).call(this);