(function(){$(document).on("pagecreate","#updates",function(){var a,b;a=function(){function a(){var a;a=pimatic.pages.index,this.updateProcessStatus=a.updateProcessStatus,this.updateProcessMessages=a.updateProcessMessages,this.hasUpdates=ko.computed(function(a){return function(){var b;return(null!=(b=a.pimaticUpdateInfo())?b.isOutdated:void 0)||a.outdatedPlugins().length>0}}(this)),this.pimaticUpdateInfoText=ko.computed(function(a){return function(){var b;return b=a.pimaticUpdateInfo(),null==b?"":b.isOutdated?__("Found update for %s: current version is %s, latest version is: %s","pimatic",b.isOutdated.current,b.isOutdated.latest):__("pimatic is up to date.")}}(this)),this.pluginUpdateInfoText=ko.computed(function(a){return function(){var b,c;return b=a.outdatedPlugins(),null==b?[]:0===b.length?[__("All plugins are up to date")]:function(){var a,d,e;for(e=[],a=0,d=b.length;d>a;a++)c=b[a],e.push(__("Found update for %s: current version is %s, latest version is: %s",c.plugin,c.current,c.latest));return e}()}}(this))}return a.prototype.pimaticUpdateInfo=ko.observable(null),a.prototype.outdatedPlugins=ko.observableArray(null),a.prototype.installUpdatesClicked=function(){var a,b;return a=this.pimaticUpdateInfo().isOutdated?["pimatic"]:[],a=a.concat(function(){var a,c,d,e;for(d=this.outdatedPlugins(),e=[],a=0,c=d.length;c>a;a++)b=d[a],e.push(b.plugin);return e}.call(this)),$.ajax({url:"/api/update",type:"POST",data:{modules:a},global:!1,timeout:1e7}).fail(function(){return function(a,b,c){return"timeout"!==b?ajaxAlertFail(a,b,c):void 0}}(this))},a.prototype.restart=function(){return $.get("/api/restart").fail(ajaxAlertFail)},a.prototype.searchForPimaticUpdate=function(){return $.ajax({url:"/api/outdated/pimatic",timeout:3e5}).done(function(a){return function(b){a.pimaticUpdateInfo(b)}}(this)).fail(ajaxAlertFail)},a.prototype.searchForOutdatedPlugins=function(){return $.ajax({url:"/api/outdated/plugins",timeout:3e5}).done(function(a){return function(b){a.outdatedPlugins(b.outdated)}}(this)).fail(ajaxAlertFail)},a}(),pimatic.pages.updates=b=new a,ko.applyBindings(b,$("#updates")[0])}),$(document).on("pageshow","#updates",function(){var a;return a=pimatic.pages.updates,a.searchForPimaticUpdate(),a.searchForOutdatedPlugins()})}).call(this);