(function(){var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};b=pimatic.tryCatch,a=function(){function a(){this.deviceEntryIcon=c(this.deviceEntryIcon,this),this.isDeviceAdded=c(this.isDeviceAdded,this),this.devices=pimatic.devices,this.refreshDeviceListView=ko.computed(function(a){return function(){return a.devices(),pimatic["try"](function(){return $("#device-items").listview("refresh")})}}(this)).extend({rateLimit:{timeout:10,method:"notifyWhenChangesStop"}})}return a.prototype.isDeviceAdded=function(a){var b,c,d,e;return b=null!=(d=pimatic.pages.index)&&null!=(e=d.activeDevicepage())?e.devices:void 0,null==b?!1:(c=ko.utils.arrayFirst(b(),function(){return function(b){return b.deviceId===a.id}}(this)),null!=c)},a.prototype.deviceEntryIcon=function(a){return this.isDeviceAdded(a)?"check":"plus"},a.prototype.addDeviceToIndexPage=function(a){var b,c;if(!this.isDeviceAdded(a)&&(b=null!=(c=pimatic.pages.index)?c.activeDevicepage():void 0,null!=b))return pimatic.client.rest.addDeviceToPage({pageId:b.id,deviceId:a.id}).done(ajaxShowToast).fail(ajaxAlertFail)},a}(),b(function(){return function(){return pimatic.pages.addItem=new a}}(this))(),$(document).on("pagecreate","#add-item",b(function(){ko.applyBindings(pimatic.pages.addItem,$("#add-item")[0]),$("#device-items").on("click","li.item",b(function(){var a;a=$(this),pimatic.pages.addItem.addDeviceToIndexPage(ko.dataFor(a[0]))})),$("#variable-items").on("click","li.item",b(function(){var a;a=$(this),pimatic.pages.addItem.addVariableToIndexPage(ko.dataFor(a[0]))})),$("#add-other").on("click","#add-a-header",b(function(){$("<div>").simpledialog2({themeDialog:"a",themeButtonDefault:"b",mode:"button",headerText:__("Name"),headerClose:!0,buttonPrompt:__("Please enter a name"),buttonInput:!0,zindex:1001,buttons:{OK:{text:__("Add"),click:function(){var a;return a=$.mobile.sdLastInput,""===a?pimatic.showToast(__("Please enter a name")):$.get("/add-header/"+a).done(function(){return pimatic.showToast(__("Header added"))}).fail(ajaxAlertFail)}}}}),setTimeout(function(){return $(".ui-simpledialog-input").focus()},1)})),$("#add-other").on("click","#add-a-button",b(function(){$("<div>").simpledialog2({themeDialog:"a",themeButtonDefault:"b",mode:"button",headerText:__("Name"),headerClose:!0,buttonPrompt:__("Please enter a name"),buttonInput:!0,zindex:1001,buttons:{OK:{text:__("Add"),click:function(){var a;return a=$.mobile.sdLastInput,""===a?pimatic.showToast(__("Please enter a name")):$.get("/add-button/"+a).done(function(){return pimatic.showToast(__("Button added"))}).fail(ajaxAlertFail)}}}}),setTimeout(function(){return $(".ui-simpledialog-input").focus()},1)}))})),$(document).on("pageshow","#add-item",b(function(){}))}).call(this);